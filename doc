#Eleccions generals 
## APARTAT 1: Importació de les dades
### Modificació de l'script sql
	Per poder posar la taula de persones hem hagut de posar persona_id com a AUTO_INCREMENT i el dni com a NULLABLE

### Introducció de dades bàsiques
	Hem hagut d'insertar una elecció de la seguent manera:
	INSERT INTO eleccions(nom,data)
		VALUES ('Elecciones al Congreso de los Diputados','2016-06-26');

### A tots els programes es repeteix la part seguent que consisteix en connectar-se al servidor i per tant ho documentarem una vegada:
	import mysql.connector

	mydb = mysql.connector.connect(
	  host="192.168.56.103",
	  user="perepi",
	  passwd="pastanaga",
	  database="mydb"
	)
### Importació de comunitats autònomes, províncies i municipis:
	Comunitats autónomes:
	
	mycursor = mydb.cursor()
	for i in f:
	    if i[9:14] == "99999":
		continue
	    elif i[11:13] == "99":
		nom_CA = i[14:63]
		cod_CA = i[9:11]
		print(nom_CA.strip(),",", cod_CA)
		sql = "INSERT INTO comunitats_autonomes (nom, codi_ine) VALUES (%s, %s)"
		val = [nom_CA.strip(), cod_CA]
		mycursor.execute(sql, val)
	    else:
		continue
	mydb.commit()
	
	Províncies:
	mycursor = mydb.cursor()
	for i in f:
	    if i[9:14] == "99999":
		continue
	    elif i[11:13] != "99":
		nom_prov = i[14:63]
		cod_ine = i[11:13]
		cod_ca = i[9:11]
		escons = i[149:154]
		print(nom_prov)
		query = ("SELECT comunitat_aut_id FROM comunitats_autonomes WHERE %s = codi_ine")
		dades = [cod_ca]
		mycursor.execute(query, dades)
		com_aut_id = mycursor.fetchone()
		com_aut_id = " ".join(map(str,com_aut_id))
		print(nom_prov, cod_ine, cod_ca, escons, com_aut_id)
		sql = "INSERT INTO provincies (comunitat_aut_id, nom, codi_ine, num_escons) VALUES (%s, %s, %s, %s)"
		val = [com_aut_id, nom_prov.strip(), cod_ine, escons]
		mycursor.execute(sql, val)
	    else:
		continue
	mydb.commit()

### Importació de partits polítics/candidatures
Per omplir la taula de candidatures, hem hagut d'utilitzar les dades del fixer 03021606.DAT i executar el següent script:

	mycursor = mydb.cursor()

	archivo = open(r"C:\Users\david\Desktop\Pràctica BDD\candidaturas.dat")

	#Candidatures

	for x in archivo:
	    codi_candidatura = x[8:14]
	    sigles_candidatura = x[14:64]
	    denom_candidatura = x[64:214]
	    cod_acom_provi = x[214:220]
	    cod_acom_auto = x[220:226]
	    cod_acom_naci = x[226:232]

	    select = mycursor.execute("SELECT eleccio_id FROM eleccions")
	    fetch = mycursor.fetchone()
	    fetch = " ".join(map(str,fetch))

	    print(codi_candidatura.strip(), ",", sigles_candidatura.strip(), ",", denom_candidatura.strip(), ",", cod_acom_provi.strip(), ",", cod_acom_auto.strip(), ",", cod_acom_naci)
	    insert = ("INSERT INTO candidatures (codi_candidatura, nom_curt, nom_llarg, codi_acumulacio_provincia, codi_acumulacio_ca, codi_acumulario_nacional, eleccio_id) VALUES (%s,%s,%s,%s,%s,%s,%s)")
	    valores = [codi_candidatura, sigles_candidatura, denom_candidatura, cod_acom_provi, cod_acom_auto, cod_acom_naci, fetch]
	    mycursor.execute(insert,valores)

	mydb.commit()
	

### Importació de candidats i persones:





### Importació de vots a nivell municipal:




### Importació de vots a nivell provincial:




### Importació de vots a nivell autonòmic:




## APARTAT 2: Creació de sentències de consulta SQL:

### Categoria 1: 5 preguntes de consultes simples: inclou una sola taula, funcions, funcions d'agregat o grups:

SELECT candidatura_id, codi_candidatura, nom_curt, nom_llarg
	FROM candidatures
WHERE nom_llarg LIKE '%partido socialista%'
ORDER BY candidatura_id;

/*-------------------------------------------------------------------------*/

SELECT codi_ine AS codi_INE_extremadura
	FROM comunitats_autonomes
WHERE nom = 'extremadura';

/*-------------------------------------------------------------------------*/

### Categoria 2: 5 preguntes de consultes de combinacions de més d'una taula: INNER JOINS, LEFT JOINS:



### Categoria 3: 5 preguntes fent ús de subconsultes:



### Categoria 4: 1 pregunta utilitzant WINDOW FUNCTIONS o recursivitat:
  


## APARTAT 5: Llei d'hondt:

Implementa un programa que mostri el nº d’escons per una província passada per paràmetre.

